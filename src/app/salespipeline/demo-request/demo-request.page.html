<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons>
      <ion-back-button defaultHref="/salespipeline">
      </ion-back-button>
      <ion-title>Demo Requisition Form</ion-title>
      <ion-button (click)="addDemoRequest()" [disabled]="!form?.valid">
        <ion-icon name="checkmark" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content>
  <form [formGroup]="form" *ngIf="!isLoading">
    <ion-grid>
      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Organization</span>
            <ion-item>
              <ion-input type="text" autocomplete autocorrect placeholder="Client Name" formControlName="orgName">
              </ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Client Status</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="orgStatus"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>

      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Statutory Detail</span>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">GST No</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="satGSTNo"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">SEZ
              </ion-label>
              <ion-select placeholder="Select One" interface="popover" formControlName="satSEZ">
                <ion-select-option value="Yes">Yes</ion-select-option>
                <ion-select-option value="No">No</ion-select-option>
              </ion-select>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>


      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Address of the Demonstration</span>
            <ion-item>
              <ion-input type="text" autocomplete autocorrect placeholder="Address" formControlName="address">
              </ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Location</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="addLocation"></ion-input>
            </ion-item>
          </ion-col>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Pin Code</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="addPincode"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">State</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="addState"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>


      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Contact Person</span>
            <ion-item>
              <ion-input type="text" autocomplete autocorrect placeholder formControlName="conName" placeholder='Name'>
              </ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Mobile No</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="conMobile"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Email</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="conEmail"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>

      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Machine detail</span>
          </ion-col>
        </ion-row>
        <div *ngFor="let item of form.get('machineDetails')['controls']; let i = index;" formArrayName="machineDetails">
          <div [formGroupName]="i">
            <ion-row>
              <ion-col size="10">
                <ion-row>
                  <ion-col size="12">
                    <ion-item>
                      <ion-label position="floating" class="label">Machine
                      </ion-label>
                      <ion-select placeholder="Select One"  interface="popover" formControlName="machineName" (ionChange)="onMachineChange($event,form.get('machineDetails')['controls'][i])">
                        <ion-select-option *ngFor="let machine of machines" [value]="machine">{{machine}}
                        </ion-select-option>
                        </ion-select>
                    </ion-item>
                  </ion-col>
                  <ion-col size="12">
                    <ion-item>
                      <ion-label position="floating" class="label">Type
                      </ion-label>
                      <ion-select placeholder="Select One"  interface="popover" formControlName="machineType">
                        <ion-select-option *ngFor="let machine of machineType" [value]="machine">{{machine}}
                        </ion-select-option>
                        </ion-select>
                    </ion-item>
                  </ion-col>
                  <ion-col size="12">
                    <ion-item>
                      <ion-label position="floating" class="label">Category
                      </ion-label>
                      <ion-select placeholder="Select One"  interface="popover" formControlName="volumeType">
                        <ion-select-option *ngFor="let machine of machineCategory" [value]="machine">{{machine}}
                        </ion-select-option>
                        </ion-select>
                    </ion-item>
                  </ion-col>
                  <ion-col size="12">
                    <ion-item>
                      <ion-label position="floating" class="label">No.of Machine
                      </ion-label>
                      <ion-input type="text" autocomplete autocorrect formControlName="machineCount"></ion-input>
                    </ion-item>
                  </ion-col>
                </ion-row>
              </ion-col>
              <ion-col size="2">
                <div style="height: 95%; border-left:2px solid #FF69B4">
                  <ion-button size="small" class=" button-assertive button-clear" style="margin-top: 75px;"
                    (click)="deleteMachine(i)">
                    <ion-icon name="trash" slot="icon-only"></ion-icon>
                  </ion-button>
                </div>
              </ion-col>
            </ion-row>
          </div>
        </div>
        <ion-row>
          <ion-col size="12">
            <ion-button size="small" (click)="addMachine()">
              <ion-icon name="add-circle"></ion-icon> Add Machine
            </ion-button>
          </ion-col>
        </ion-row>
      </div>

      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Accessories</span>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Installation/Demo Kit</ion-label>
              <ion-select placeholder="Select One"  interface="popover" formControlName="accInstallation" multiple>
                <ion-select-option *ngFor="let kit of installkititems" [value]="kit">{{kit}}
                </ion-select-option>
                </ion-select>
            </ion-item>
          </ion-col>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Other Accessories</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="accOther"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>


      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Terms of Installation</span>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Demo</ion-label>
              <ion-select placeholder="Select One" interface="popover" formControlName="instDemo">
                <ion-select-option value="Free">Free</ion-select-option>
                <ion-select-option value="Chargeble">Chargeble</ion-select-option>
              </ion-select>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>


      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Date</span>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Date of Delivery
              </ion-label>
              <ion-datetime formControlName="dateDelivery" display-format="MMM DD YYYY" picker-format="YY MMM DD">
              </ion-datetime>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Start Date of Demo
              </ion-label>
              <ion-datetime formControlName="dateDemo" display-format="MMM DD YYYY" picker-format="YY MMM DD">
              </ion-datetime>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">End Date of Demo
              </ion-label>
              <ion-datetime formControlName="dateEndDemo" display-format="MMM DD YYYY" picker-format="YY MMM DD">
              </ion-datetime>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">Date of Pickup
              </ion-label>
              <ion-datetime formControlName="datePickup" display-format="MMM DD YYYY" picker-format="YY MMM DD">
              </ion-datetime>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>

      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Details of Consumption</span>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">No.Employee
              </ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="cnsNoEmp"></ion-input>
            </ion-item>
          </ion-col>
          <ion-col size-sm="3" offset-sm="3">
            <ion-item>
              <ion-label position="floating" class="label">No.of Cups /day</ion-label>
              <ion-input type="text" autocomplete autocorrect formControlName="cnsNoCups"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
      </div>

      <div class="section">
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <span style="font-size:13px">Details of Material</span>
          </ion-col>
        </ion-row>
        <div *ngFor="let item of form.get('materialDetails')['controls']; let i = index;"
          formArrayName="materialDetails">
          <div [formGroupName]="i">
            <ion-row>
              <ion-col size="10">
                <ion-row>
                  <ion-col size="12">
                    <ion-item>
                      <ion-label position="floating" class="label">Material
                      </ion-label>
                      <ion-select placeholder="Select One"  interface="popover" formControlName="category" (ionChange)="onMaterialChange($event,form.get('materialDetails')['controls'][i])">
                        <ion-select-option *ngFor="let stock of stockCategory" [value]="stock">{{stock}}
                        </ion-select-option>
                        </ion-select>
                    </ion-item>
                  </ion-col>
                  <ion-col  size="12">
                    <ion-item>
                      <ion-label position="floating" class="label">Type
                      </ion-label>
                      <ion-select placeholder="Select One"  interface="popover" formControlName="item" (ionChange)="onMaterialTypeChange($event,form.get('materialDetails')['controls'][i])">
                        <ion-select-option *ngFor="let stock of stockType" [value]="stock">{{stock}}
                        </ion-select-option>
                        </ion-select>
                    </ion-item>
                  </ion-col>
                  <ion-col size="12">
                    <ion-item color="success">
                      <ion-label position="floating" class="label"  style="color: #fff;">UOM
                      </ion-label>
                      <ion-input type="text" autocomplete autocorrect formControlName="uom" readonly></ion-input>
                    </ion-item>
                  </ion-col>
                  <ion-col size="12">
                    <ion-item  color="success">
                      <ion-label position="floating" class="label"  style="color: #fff;">HSNCode
                      </ion-label>
                      <ion-input type="text" autocomplete autocorrect formControlName="hsnNo" readonly></ion-input>
                    </ion-item>
                  </ion-col>
                  <ion-col size="12">
                    <ion-item  color="success">
                      <ion-label position="floating" class="label" style="color: #fff;">GST
                      </ion-label>
                      <ion-input type="text" autocomplete autocorrect formControlName="gst"
                      [value]="item.get('gst').value"
                      readonly></ion-input>
                    </ion-item>
                  </ion-col>
                  <ion-col  size="12">
                    <ion-item>
                      <ion-label position="floating" class="label">Qty
                      </ion-label>
                      <ion-input type="text" autocomplete autocorrect formControlName="qty"></ion-input>
                    </ion-item>
                  </ion-col>
                </ion-row>
              </ion-col>
              <ion-col size="2">
                <div style="height: 95%; border-left:2px solid #FF69B4;">
                  <ion-button size="small" class=" button-assertive button-clear" style="margin-top: 75px;"
                    (click)="deleteMaterial(i)">
                    <ion-icon name="trash" slot="icon-only"></ion-icon>
                  </ion-button>
                </div>
              </ion-col>
            </ion-row>
          </div>
        </div>
        <ion-row>
          <ion-col size-sm="6" offset-sm="3">
            <ion-button size="small" (click)="addMaterial()">
              <ion-icon name="add-circle"></ion-icon> Add Material
            </ion-button>
          </ion-col>
        </ion-row>
      </div>





    </ion-grid>
  </form>
</ion-content>
